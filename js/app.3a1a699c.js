(function(e){function t(t){for(var s,n,l=t[0],c=t[1],d=t[2],u=0,b=[];u<l.length;u++)n=l[u],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&b.push(a[n][0]),a[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);i&&i(t);while(b.length)b.shift()();return r.push.apply(r,d||[]),o()}function o(){for(var e,t=0;t<r.length;t++){for(var o=r[t],s=!0,l=1;l<o.length;l++){var c=o[l];0!==a[c]&&(s=!1)}s&&(r.splice(t--,1),e=n(n.s=o[0]))}return e}var s={},a={app:0},r=[];function n(t){if(s[t])return s[t].exports;var o=s[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=s,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/xmas-lights/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var i=c;r.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("cd49")},"0f8e":function(e,t,o){},c73d:function(e,t,o){"use strict";o("0f8e")},cd49:function(e,t,o){"use strict";o.r(t);var s=o("7a23");const a={class:"container pt-4"},r=Object(s["e"])("h4",null,"About this site",-1),n=Object(s["e"])("p",null,"This website lets you put in a series of christmas light addresses, and get a Google Maps link in return that shows you the fastest way to see all the lights.",-1),l=Object(s["e"])("h4",null,"Get Started",-1),c={class:"accordion pt-4"},d=Object(s["e"])("p",{class:"text-warning"},[Object(s["f"])("When adding addresses, make sure they're spelled correctly, and fully. For example use "),Object(s["e"])("code",null,"123 Fake Street"),Object(s["f"])(" instead of "),Object(s["e"])("code",null,"123 Fake St"),Object(s["f"])(". And make sure to only add one address at a time. Do not use "),Object(s["e"])("code",null,"123 and 124 Fake Street"),Object(s["f"])(" because that won't work! ")],-1),i={key:0,class:"alert alert-danger"},u=Object(s["e"])("p",null,"Step 2: Valid addresses will appear in the table below. If your starting address is not the same as the first address, pick the starting address from the list",-1),b={class:"table table-striped table-hover table-dark"},p=Object(s["e"])("thead",null,[Object(s["e"])("tr",{scope:"row"},[Object(s["e"])("th",null,"Address"),Object(s["e"])("th",null,"City"),Object(s["e"])("th",null,"State"),Object(s["e"])("th",null,"Country"),Object(s["e"])("th",null,"Postcode"),Object(s["e"])("th",null,"Start Here"),Object(s["e"])("th",null,"Stop Here"),Object(s["e"])("th",null,"Delete")])],-1),h=["value","name","id","checked"],m=["value","name","id","checked"],j=["onClick"],O=Object(s["e"])("p",null,[Object(s["f"])("Step 3: Enter your OpenRouteService API Key. If you don't have one, sign up for one "),Object(s["e"])("a",{href:"https://openrouteservice.org/dev/#/login"},"here")],-1),f=Object(s["e"])("label",{for:"apiKey",class:"form-label"},"OpenRouteService API Key",-1),y=Object(s["e"])("p",null,"Step 4: Set your options here. These are for advanced users only and you generally don't need to touch them ",-1),g=Object(s["e"])("label",{for:"chunkSize",class:"form-label"},"Number of routes per map",-1),v=Object(s["e"])("div",{class:"form-text"},"If you have more than this many routes on your map, your results will be split up into multiple maps. Google only allows 25 stops per route",-1),k=Object(s["e"])("label",{for:"maxAddress",class:"form-label"},"Maximum number of addresses",-1),w=Object(s["e"])("div",{class:"form-text text-warning"},"NOTE: The free OpenRouteService API key can only optimize 40 addresses at once. Do NOT increase this unless you have a paid key!",-1),A=Object(s["e"])("p",null,"Step 5: Click on the button. Your route will be sent to OpenRouteService and the shortest path will be found. The results will come back as a set of Google Maps links",-1),S=["disabled"],x={key:0,class:"pt-4"},I=Object(s["e"])("p",null,"Your maps are below. Because Google Maps only lets you do 25 stops per trip, your trip may have been split into two or more maps. Each subsequent map continues where the first one left off. Make sure to save each one to your phone",-1),z=["href"],M=Object(s["e"])("h4",null,"How does this site work?",-1),R=Object(s["e"])("p",null,"The site uses two services: OpenStreetMap's Nominatim service, and OpenRouteService's route optimization service. When you add an address, the address is sent to Nominatim, and a pair of coordinates are returned if the location exists. When you click the button to get the optimized route, the list of coordinates are sent to ORS who then return the same coordinates, but sorted by most efficient route.",-1),T=Object(s["e"])("p",null,"Those coordinates are then turned back into physical addresses (because Nominatim isn't very accurate) and a Google Maps link is generated that you can click on to use to navigate.",-1),q=Object(s["e"])("h4",null,"When I click the link on my computer, I can't find the button to send the directions to my phone",-1),C=Object(s["e"])("p",null,[Object(s["f"])("Normally Google Maps only lets you do 9 stops per trip, but if you build your own Google Maps link, you can do up to 25 before it stops trying to navigate. In order to see the button to send to your phone or share the link, you need to zoom out in your browser, usually by pressing "),Object(s["e"])("code",null,"Ctrl+Minus"),Object(s["f"])(" (or "),Object(s["e"])("code",null,"Cmd+Minus"),Object(s["f"])(" on a Mac) until you can see the buttons at the bottom ")],-1),E=Object(s["e"])("h4",null,"When I open the link in Google Maps on my phone, it won't let me navigate, it just shows a preview and the steps",-1),G=Object(s["e"])("p",null,'This is due to the aforementioned 9-stop limit. If you can open the site in Google Maps in the browser (not the in Google Maps app!), then there will be a "Navigate In App" button you can click on in order to start navigation.',-1),U=Object(s["e"])("p",null,"This has only been tested on my Google Pixel 6, and not on any other phone or any other version of Google Maps",-1),P=Object(s["e"])("h4",null,"Why do I need to provide a key for ORS? Can't you give me one?",-1),V=Object(s["e"])("p",null,"This site runs entirely within your browser. If I were to set a default key, anyone could find it and use it, and the 500 calls a day the free key gives you will disappear very quickly, so that's why the site needs you to get your own key. The Nominatim system is a bit different, as they just require you to specify an email address so they can see who is making calls and give you more calls per minute, no account required.",-1),N=Object(s["e"])("h4",null,"Where can I report bugs?",-1),_=Object(s["e"])("p",null,[Object(s["f"])("Open an issue on the Github repo "),Object(s["e"])("a",{href:"https://github.com/grayda/xmas-lights/issues"},"here"),Object(s["f"])(". If you came here from my Facebook comment, you can reply there too.")],-1);function K(e,t,o,K,L,F){const H=Object(s["n"])("Header"),W=Object(s["n"])("AddressForm"),Y=Object(s["n"])("AccordionItem");return Object(s["j"])(),Object(s["d"])(s["a"],null,[Object(s["g"])(H),Object(s["e"])("div",a,[r,n,Object(s["e"])("p",null,"This site runs entirely within your web-browser and works on routes up to "+Object(s["o"])(e.maxAddresses)+" stops. If you need more stops, download your results and go again",1),l,Object(s["e"])("div",c,[Object(s["g"])(Y,{header:"Step 1: Add Locations",id:"locations",show:!0},{default:Object(s["r"])(()=>[Object(s["e"])("p",null,"Step 1: Type in the addresses you wish to add. You may add up to "+Object(s["o"])(e.maxAddresses)+" locations. If you need more locations, do the "+Object(s["o"])(e.maxAddresses)+" first, then add the next "+Object(s["o"])(e.maxAddresses)+", and so on. ",1),d,Object(s["g"])(W,{onAddressAdded:e.addAddress,onError:e.errorAdding,addresses:e.addresses,maxAddresses:40},null,8,["onAddressAdded","onError","addresses"]),e.error?(Object(s["j"])(),Object(s["d"])("p",i,Object(s["o"])(e.error),1)):Object(s["c"])("",!0)]),_:1}),Object(s["g"])(Y,{header:"Step 2: Review information",id:"review",show:!0},{default:Object(s["r"])(()=>[u,Object(s["e"])("p",null,"Total Addresses: "+Object(s["o"])(e.addresses.length),1),Object(s["e"])("table",b,[p,Object(s["e"])("tbody",null,[(Object(s["j"])(!0),Object(s["d"])(s["a"],null,Object(s["l"])(e.addresses,(o,a)=>(Object(s["j"])(),Object(s["d"])("tr",{key:o.address,scope:"row"},[Object(s["e"])("td",null,Object(s["o"])(o["address"]),1),Object(s["e"])("td",null,Object(s["o"])(o["city"]),1),Object(s["e"])("td",null,Object(s["o"])(o["state"]),1),Object(s["e"])("td",null,Object(s["o"])(o["country"]),1),Object(s["e"])("td",null,Object(s["o"])(o["postcode"]),1),Object(s["e"])("td",null,[Object(s["s"])(Object(s["e"])("input",{type:"radio",value:a,name:"start"+o.address,id:"start"+o.address,checked:a==e.start,"onUpdate:modelValue":t[0]||(t[0]=t=>e.start=t),class:"form-check-input"},null,8,h),[[s["p"],e.start]])]),Object(s["e"])("td",null,[Object(s["s"])(Object(s["e"])("input",{type:"radio",value:a,name:"stop"+o.address,id:"stop"+o.address,checked:a==e.stop,"onUpdate:modelValue":t[1]||(t[1]=t=>e.stop=t),class:"form-check-input"},null,8,m),[[s["p"],e.stop]])]),Object(s["e"])("td",null,[Object(s["e"])("a",{href:"#",onClick:Object(s["t"])(t=>e.deleteAddress(a),["prevent"]),class:"btn btn-danger"},"Ã—",8,j)])]))),128))])])]),_:1}),Object(s["g"])(Y,{header:"Step 3: Enter your OpenRouteService Key",id:"orsKey"},{default:Object(s["r"])(()=>[O,Object(s["e"])("form",null,[f,Object(s["s"])(Object(s["e"])("input",{type:"text",class:"form-control form-control-lg",placeholder:"3e8c47f2b7a77b1055b88d89cec16e4ab7c4e08d37b7a8a9a9ed7713","onUpdate:modelValue":t[2]||(t[2]=t=>e.apiKey=t)},null,512),[[s["q"],e.apiKey]])])]),_:1}),Object(s["g"])(Y,{header:"Step 4: Set your options (optional)",id:"options"},{default:Object(s["r"])(()=>[y,Object(s["e"])("form",null,[g,Object(s["s"])(Object(s["e"])("input",{type:"number",max:"25",min:"5",class:"form-control form-control-lg",placeholder:"24","onUpdate:modelValue":t[3]||(t[3]=t=>e.chunkSize=t)},null,512),[[s["q"],e.chunkSize]]),v,k,Object(s["s"])(Object(s["e"])("input",{type:"number",min:"40",class:"form-control form-control-lg",placeholder:"40","onUpdate:modelValue":t[4]||(t[4]=t=>e.maxAddresses=t)},null,512),[[s["q"],e.maxAddresses]]),w])]),_:1}),Object(s["g"])(Y,{header:"Step 5: Get your optimized route",id:"getRoute"},{default:Object(s["r"])(()=>[A,Object(s["e"])("button",{onClick:t[5]||(t[5]=Object(s["t"])((...t)=>e.optimizeAddresses&&e.optimizeAddresses(...t),["prevent"])),disabled:0==e.addresses.length||!e.apiKey,class:"btn btn-primary btn-lg"},"Go",8,S),e.mapRoute.length>0?(Object(s["j"])(),Object(s["d"])("div",x,[I,(Object(s["j"])(!0),Object(s["d"])(s["a"],null,Object(s["l"])(e.mapRoute,(e,t)=>(Object(s["j"])(),Object(s["d"])("p",{key:e},[Object(s["e"])("a",{href:e},"Map "+Object(s["o"])(t+1),9,z)]))),128))])):Object(s["c"])("",!0)]),_:1}),Object(s["g"])(Y,{header:"Additional Information",id:"extrainfo"},{default:Object(s["r"])(()=>[M,R,T,q,C,E,G,U,P,V,N,_]),_:1})])])],64)}o("14d9"),o("1de3"),o("7b17");const L=Object(s["e"])("div",{class:"navbar navbar-expand-lg navbar-dark bg-primary"},[Object(s["e"])("div",{class:"container-fluid"},[Object(s["e"])("a",{class:"navbar-brand"},"XMAS-LIGHTS")])],-1),F=[L];function H(e,t,o,a,r,n){return Object(s["j"])(),Object(s["d"])("div",null,F)}var W=Object(s["h"])({name:"Header"}),Y=o("6b0d"),D=o.n(Y);const J=D()(W,[["render",H]]);var $=J;const B={class:"form-group"},X={class:"row"},Q={class:"col"},Z=Object(s["e"])("label",{class:"form-label",for:"address"},"Address",-1),ee={class:"row"},te={class:"col"},oe=Object(s["e"])("label",{class:"form-label",for:"city"},"City",-1),se={class:"col"},ae=Object(s["e"])("label",{class:"form-label",for:"state"},"State",-1),re={class:"col"},ne=Object(s["e"])("label",{class:"form-label",for:"country"},"Country",-1),le={class:"col"},ce=Object(s["e"])("label",{class:"form-label",for:"postcode"},"Postcode",-1),de={class:"col"},ie=Object(s["e"])("label",{class:"form-label",for:"email"},"Email Address",-1),ue=Object(s["e"])("div",{class:"row py-3"},[Object(s["e"])("small",{class:"text-light"},[Object(s["f"])("Your email address is not used by this site. It's used by "),Object(s["e"])("a",{href:"https://nominatim.org/"},"Nominatim"),Object(s["f"])(" to keep track of who is looking up addresses")])],-1),be={class:"row py-4"},pe=["disabled"];function he(e,t,o,a,r,n){return Object(s["j"])(),Object(s["d"])("div",null,[Object(s["e"])("form",null,[Object(s["e"])("div",B,[Object(s["e"])("div",X,[Object(s["e"])("div",Q,[Z,Object(s["s"])(Object(s["e"])("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.address=t),class:"form-control form-control-lg",type:"text",autocomplete:"address-line1",name:"address",placeholder:"1000 Collins Street",required:""},null,512),[[s["q"],e.address]])])]),Object(s["e"])("div",ee,[Object(s["e"])("div",te,[oe,Object(s["s"])(Object(s["e"])("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.city=t),class:"form-control form-control-lg",type:"text",autocomplete:"address-level2",name:"city",placeholder:"Melbourne",required:""},null,512),[[s["q"],e.city]])]),Object(s["e"])("div",se,[ae,Object(s["s"])(Object(s["e"])("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.state=t),class:"form-control form-control-lg",type:"text",autocomplete:"address-level1",name:"state",placeholder:"Victoria",required:""},null,512),[[s["q"],e.state]])]),Object(s["e"])("div",re,[ne,Object(s["s"])(Object(s["e"])("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.country=t),class:"form-control form-control-lg",type:"text",autocomplete:"country-name",name:"country",placeholder:"Australia"},null,512),[[s["q"],e.country]])]),Object(s["e"])("div",le,[ce,Object(s["s"])(Object(s["e"])("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.postcode=t),class:"form-control form-control-lg",type:"text",autocomplete:"postal-code",name:"postcode",placeholder:"3000"},null,512),[[s["q"],e.postcode]])]),Object(s["e"])("div",de,[ie,Object(s["s"])(Object(s["e"])("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.email=t),class:"form-control form-control-lg",type:"email",autocomplete:"email",name:"email",placeholder:"user@example.com"},null,512),[[s["q"],e.email]])])]),ue,Object(s["e"])("div",be,[Object(s["e"])("button",{class:Object(s["i"])({"form-control form-control-lg btn btn-lg btn-success":!0,disabled:!e.canSubmit}),type:"submit",onClick:t[6]||(t[6]=Object(s["t"])((...t)=>e.searchAddress&&e.searchAddress(...t),["prevent","self"])),disabled:!e.canSubmit},Object(s["o"])(e.loading),11,pe)])])])])}o("d9e2");function me(){const e=Object(s["k"])(null),t=Object(s["k"])(""),o=Object(s["k"])(null),a=Object(s["k"])(null),r=Object(s["k"])(null),n=Object(s["k"])(null),l=Object(s["k"])(),c=Object(s["k"])(0),d=Object(s["k"])(0);async function i(){l.value=[t.value,o.value,a.value,r.value,n.value].join(", ");const s=[];switch(!0){case null==e.value:s.push("email");break;case null==t.value:s.push("address");break;case null==o.value:s.push("city");break;case null==a.value:s.push("state");break;case null==r.value:s.push("country");break;case null==n.value:s.push("postcode");break}if(s.length>0)throw new Error("Unable to look up address because these fields are missing: "+s.join(", "));return await fetch("https://nominatim.openstreetmap.org/search?format=json&email="+e.value+"&q="+encodeURIComponent(l.value)).then(e=>{if(e.ok)return e.json();throw new Error("Unable to contact Nominatim. You might be rate limited?")}).then(e=>{if(e.length>0)return c.value=parseFloat(e[0].lat),d.value=parseFloat(e[0].lon),!0;throw new Error("Unable to find "+l.value+". Check for spelling mistakes and try again!")}).catch(e=>{throw new Error(e)}),!0}return{getLatLong:i,address:t,city:o,state:a,country:r,postcode:n,email:e,fullAddress:l,latitude:c,longitude:d}}var je=Object(s["h"])({name:"AddressForm",setup(){const{getLatLong:e,address:t,city:o,state:s,country:a,postcode:r,email:n,fullAddress:l,latitude:c,longitude:d}=me();return{getLatLong:e,address:t,city:o,state:s,country:a,postcode:r,email:n,fullAddress:l,latitude:c,longitude:d}},props:["addresses","maxAddresses"],computed:{canSubmit(){return"Add Address"===this.loading&&(!(this.addresses.length>=this.maxAddresses)&&!!(this.address&&this.city&&this.state&&this.country&&this.postcode&&this.email))}},data(){return{errorMessage:null,loading:"Add Address"}},methods:{async searchAddress(){try{this.loading="Loading..",await this.getLatLong(),this.loading="Add Address",this.$emit("address-added",{address:this.address,fullAddress:this.fullAddress,city:this.city,state:this.state,country:this.country,postcode:this.postcode,latitude:this.latitude,longitude:this.longitude}),this.address=""}catch(e){this.$emit("error",{fullAddress:this.fullAddress,error:e}),this.loading="Add Address"}}}});const Oe=D()(je,[["render",he]]);var fe=Oe;const ye={class:"accordion-item"},ge=["id"],ve=["data-bs-target","aria-controls"],ke=["id","aria-labelledby"],we={class:"accordion-body"};function Ae(e,t,o,a,r,n){return Object(s["j"])(),Object(s["d"])("div",ye,[Object(s["e"])("h2",{class:"accordion-header text-bg-dark",id:"heading"+e.id},[Object(s["e"])("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapse"+e.id,"aria-expanded":"true","aria-controls":"collapse"+e.id},Object(s["o"])(e.header),9,ve)],8,ge),Object(s["e"])("div",{id:"collapse"+e.id,class:Object(s["i"])(["accordion-collapse collapse",e.show?"show":""]),"aria-labelledby":"heading"+e.id,"data-bs-parent":"#accordionExample"},[Object(s["e"])("div",we,[Object(s["m"])(e.$slots,"default")])],10,ke)])}var Se=Object(s["h"])({name:"AccordionItem",props:["id","show","header"]});const xe=D()(Se,[["render",Ae]]);var Ie=xe;function ze(){const e=Object(s["k"])([]),t=Object(s["k"])("");async function o(o,s,a){const r={jobs:[],vehicles:[]};o.forEach((e,t,o)=>{t!=s?r.jobs.push({id:t,description:e.fullAddress,location:[e.longitude,e.latitude]}):r.vehicles.push({id:t,profile:"driving-car",start:[e.longitude,e.latitude],end:[e.longitude,e.latitude],description:e.fullAddress})}),await fetch("https://api.openrouteservice.org/optimization",{method:"post",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, application/geo+json, application/gpx+xml, img/png; charset=utf-8",Authorization:t.value},body:JSON.stringify(r)}).then(e=>{if(e.ok)return e.json();throw new Error("Error optimizing route")}).then(t=>{const r=[],n=o[s],l=o[a];r.push(n),t["routes"][0]["steps"].forEach(e=>{"job"==e.type&&r.push(o[e.id])}),r.push(l),e.value=r})}return{optimizeRoute:o,optimizedRoute:e,apiKey:t}}var Me=Object(s["h"])({name:"App",components:{Header:$,AddressForm:fe,AccordionItem:Ie},setup(){const{optimizeRoute:e,apiKey:t,optimizedRoute:o}=ze();return{optimizeRoute:e,apiKey:t,optimizedRoute:o}},computed:{mapRoute(){const e=[];for(let o=0;o<this.optimizedRoute.length;o+=this.chunkSize){const s=this.optimizedRoute.slice(o,o+this.chunkSize);var t="";s.forEach(e=>{t+=encodeURIComponent(e.fullAddress)+"/"}),e.push(["https://www.google.com.au/maps/dir/",t].join(""))}return e}},data(){return{addresses:[],error:"",start:0,stop:0,chunkSize:25,maxAddresses:40}},methods:{addAddress(e){const t=this.addresses.find(t=>e.fullAddress==t.fullAddress);t?this.error="This address already exists":(this.addresses.push(e),this.error="")},errorAdding(e){this.error=e.error},deleteAddress(e){this.addresses.splice(e,1),this.start==e&&(this.start=0)},optimizeAddresses(){this.optimizeRoute(this.addresses,this.start,this.stop)}}});o("c73d");const Re=D()(Me,[["render",K]]);var Te=Re;Object(s["b"])(Te).mount("#app")}});
//# sourceMappingURL=app.3a1a699c.js.map